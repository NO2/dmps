<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html">
	<title>Simulator</title>
</head>
<body>
	<!--<iframe id="frmFile1" src="gen0.dat" onload="LoadFile1();" style="display: none;"></iframe>-->
	<iframe id="frmFile2" src="path0.dat" onload="LoadFile2();" style="display: none;"></iframe>
	<script type="text/javascript">
		//read file
		var canvas = document.createElement("canvas");
		var ctx = canvas.getContext("2d");
		canvas.width = 420;//n+2
		canvas.height = 240;
		document.body.appendChild(canvas);
        

// Background image
//var bgReady = false;
//var bgImage = new Image();
//bgImage.onload = function () {
//	bgReady = true;
//};
//bgImage.src = "images/background.png";
		var dataReady=false;
		var d1r=false,d2r=false;
		var hero = {
			x: 0
		};
		//array of cars
        var update = function (modifier) {
			if (!dataReady) dataReady=d1r&&d2r;
	
		//update position if requires, see t elapsed, remove cars from array, add to array etc
		};
		var render = function () {
			//if (bgReady) {
			//	ctx.drawImage(bgImage, 0, 0);
			//}

		//if (heroReady) {
		//	ctx.drawImage(heroImage, hero.x, hero.y);
		//}
		//draw person
		//draw cars
		//if (monsterReady) {
		//ctx.drawImage(monsterImage, monster.x, monster.y);
		//}
		};
		var main = function () {
			var now = Date.now();
			var delta = now - then;
			//setinterval?
			update(delta / 1000);
			render();

			then = now;

			// Request to do this again ASAP
			requestAnimationFrame(main);


		};
		function LoadFile1() {
    		var oFrame = document.getElementById("frmFile1");
    		var strRawContents = oFrame.contentWindow.document.body.childNodes[0].innerHTML;
    		while (strRawContents.indexOf("\r") >= 0)
   			     strRawContents = strRawContents.replace("\r", "");
    		var arrLines = strRawContents.split("\n");
    		alert("File " + oFrame.src + " has " + arrLines.length + " lines");
    		for (var i = 0; i < arrLines.length; i++) {
        		var curLine = arrLines[i];
        		alert("Line #" + (i + 1) + " is: '" + curLine + "'");
    		}
			d1r=true;
		}
		function LoadFile2() {
    		var oFrame = document.getElementById("frmFile2");
    		var strRawContents = oFrame.contentWindow.document.body.childNodes[0].innerHTML;
    		while (strRawContents.indexOf("\r") >= 0)
   			     strRawContents = strRawContents.replace("\r", "");
    		var arrLines = strRawContents.split("\n");
    		alert("File " + oFrame.src + " has " + arrLines.length + " lines");
    		for (var i = 0; i < arrLines.length; i++) {
        		var curLine = arrLines[i];
        		alert("Line #" + (i + 1) + " is: '" + curLine + "'");
    		}
			d2r=true;
		}
main();
    </script>

  

</body>
</html>
